(this.webpackJsonpreactapptestausa=this.webpackJsonpreactapptestausa||[]).push([[0],{227:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=227},252:function(e,t,n){e.exports=n(278)},257:function(e,t,n){},263:function(e,t){},264:function(e,t){},272:function(e,t){},274:function(e,t){},275:function(e,t){},276:function(e,t){},277:function(e,t,n){},278:function(e,t,n){"use strict";n.r(t);var a=n(59),o=n.n(a),c=n(228),i=n.n(c),r=(n(257),n(73)),s=n(94),l=n(250),d=n.n(l);n(277);const u={1:{name:"person",color:"red"},2:{name:"ThumbsDown",color:"yellow"},3:{name:"ThankYou",color:"lime"},4:{name:"LiveLong",color:"blue"}};var g=function(){const e=Object(a.useRef)(null),t=Object(a.useRef)(null),[n,c]=Object(a.useState)("webcam");var i,l,g,h,m,p,f,[w,v]=Object(a.useState)({width:1440,height:1080}),y=!1,b=(new Image,[]),x=[],E=[],C=[],j=[],O=[],k=0,I=new Set;const D=document.createElement("li");var N,M,S;D.id="lista immagini",D.style.display="block",document.createElement("div").style.display="block";var T=[];async function B(e,t){const n=k++,a=new Image(640,480);a.src=e.src,a.id=t,a.onload=await(async function(){const e=await Promise.all(["Elon Musk","Marco","Obama"].map(async e=>{var t=[];for(f=1;f<=8;f++){const n=await r.g("/tfodreactapptest"+"/labels/".concat(e,"/").concat(f,".jpeg")),a=await r.e(n).withFaceLandmarks().withFaceDescriptor();t.push(a.descriptor)}return new r.b(e,t)})),t=new r.a(e),o=r.c(a),c={width:640,height:480};r.h(o,c);const i=await r.d(a).withFaceLandmarks().withFaceDescriptors(),s=r.j(i,c),l=s.map(e=>t.findBestMatch(e.descriptor));console.log(l.length);var d=0;if(0!==l.length){if(s.length>=1){const e=t.findBestMatch(s[0].descriptor),c=s[0].detection.box,i=new r.f.DrawBox(c,{label:e});console.log(e),console.log(c),console.log(i),console.log(n),o.width=640,o.height=480,o.style.zIndex=10,o.id="ritaglio";const l=o.getContext("2d"),u=document.createElement("div");u.style.display="flex";let g=!0;console.log("prima "+n),!I.has(a.src)&&g&&!("undefined"===typeof a)&!("undefined"===typeof a.src)&&(console.log("dentro "+n),await l.drawImage(a,0,0),await i.draw(o),document.body.append(D),u.appendChild(o),d=document.createTextNode(a.id),S=document.createTextNode("   "+n),console.log(d),u.appendChild(d),u.appendChild(S),u.id=d.textContent,u.className="immagini",D.appendChild(u),console.log("container "+n),g=!1,I.add(a.src)),console.log("dopo "+n)}}else{o.width=640,o.height=480,o.style.zIndex=10,o.id="ritaglio";const e=o.getContext("2d"),t=document.createElement("div");t.style.display="flex",t.setAttribute("name","No");let c=!0;console.log("ggggggg"),!I.has(a.src)&&c&&!("undefined"===typeof a)&!("undefined"===typeof a.src)&&(console.log("dentro "+n),await e.drawImage(a,0,0),document.body.append(D),t.appendChild(o),d=document.createTextNode(a.id),S=document.createTextNode("   "+n),console.log(d),t.appendChild(d),t.appendChild(S),t.id=d.textContent,D.appendChild(t),console.log("container "+n),c=!1,I.add(a.src))}})}async function L(e,t,n,a,o,c){if(e&&t&&n&&a&&o&&c){var r=document.createElement("canvas");r.width=640,r.height=480;var s=r.getContext("2d"),l=new Image(640,480);l.src=e,l.onload=async function(){await s.drawImage(l,640*t,480*n,640*a,480*o,0,0,640*a,480*o),i=await r.toDataURL("image/png"),document.getElementById("screenshot").src=i,y=!1;document.getElementById("screenshot");var e=document.createElement("img");e.src=await i,T.push(e),console.log("face recognition"),await async function(e,t){for(var n=0;n<e.length;n++){var a=e[n];await B(a,t)}}(T.slice(),c.slice())}}}async function A(e,t,n,a,o,c,i){if(e&&i&&c&&t&&n&&a&&o)for(var r=0;r<i.length;r++)await L(i[r],t[r],n[r],a[r],o[r],c[r])}navigator.mediaDevices.enumerateDevices().then(e=>console.log(e));const F=async n=>{var a=document.getElementById("webcam");if("undefined"!==typeof e.current&&null!==e.current&&4===e.current.video.readyState){console.log("Pausing the webcam stream..."),e.current.video.pause(),M=((N=new Date).getHours()<10?"0"+N.getHours():N.getHours())+":"+(N.getMinutes()<10?"0"+N.getMinutes():N.getMinutes())+":"+(N.getSeconds()<10?"0"+N.getSeconds():N.getSeconds());var o=a.currentTime;console.log(o),console.log("Webcam stream paused.");const c=e.current.video,i=e.current.video.srcObject,r=e.current.video.videoWidth,d=e.current.video.videoHeight;e.current.video.width=r,e.current.video.height=d,t.current.width=r,t.current.height=d;const f=await s.a.fromPixels(c),w=await s.c.resizeBilinear(f,[640,480]),v=await w.cast("int32"),k=await v.expandDims(0),I=await n.executeAsync(k),D=await I[1].array(),S=await I[0].array(),B=await I[4].array(),L=t.current.getContext("2d");b=[],x=[],O=[],j=[],E=[],C=[],T=[],await async function(){for(var t=0;t<B[0].length;t++)if(B[0][t]>.3&&1==S[0][t])p=await e.current.getScreenshot(),b.push(p),x.push(M),y=!0,l=D[0][t][1],E.push(l),g=D[0][t][0],C.push(g),h=D[0][t][3]-D[0][t][1],j.push(h),m=D[0][t][2]-D[0][t][0],O.push(m);else if(y){await A(y,E.slice(),C.slice(),j.slice(),O.slice(),x.slice(),b.slice());break}}(),console.log(D[0][0]),((e,t,n,a,o,c,i)=>{for(let r=0;r<=e.length;r++)if(e[r]&&t[r]&&n[r]>a){const[a,s,l,d]=e[r],g=t[r];1===g&&(i.strokeStyle=u[g].color,i.lineWidth=5,i.fillStyle="white",i.font="30px Arial",i.beginPath(),i.fillText(u[g].name+" - "+Math.round(100*n[r])/100,s*o,a*c-10),i.rect(s*o,a*c,(d-s)*o,(l-a)*c),i.stroke())}})(D[0],S[0],B[0],.3,r,d,L),34.48===o&&(o=0),e.current.video.srcObject=null,a.currentTime=await o,e.current.video.srcObject=await i,s.b(f),s.b(w),s.b(v),s.b(k),s.b(I)}return p};return Object(a.useEffect)(()=>{(async()=>{const e=await s.d("https://testtfodausa.s3.eu-de.cloud-object-storage.appdomain.cloud/model.json");Promise.all([r.i.ssdMobilenetv1.loadFromUri("/tfodreactapptest/models"),r.i.faceLandmark68Net.loadFromUri("/tfodreactapptest/models"),r.i.faceRecognitionNet.loadFromUri("/tfodreactapptest/models")]),setInterval(()=>{F(e)},5e3)})()},[]),o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"App-header"},o.a.createElement(d.a,{ref:e,videoConstraints:w,id:"webcam",muted:!0,style:{position:"absolute",marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center",zindex:9,width:640,height:480}}),o.a.createElement("canvas",{ref:t,style:{position:"absolute",marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center",zindex:8,width:640,height:480}}),o.a.createElement("img",{id:"screenshot",alt:"Screenshot",style:{width:640,height:480}})),o.a.createElement("button",{onClick:function(){var t=document.getElementById("webcam");e.current.video.srcObject&&(e.current.video.pause(),e.current.video.srcObject=null,t.src="/tfodreactapptest/video/alley.mp4",t.width=640,t.height=480,t.style.width="640px",t.style.height="480px",t.style.aspectRatio="4 / 3",t.play())}},"Test video 1"),o.a.createElement("button",{onClick:function(){var t=e.current.video;if(!t.srcObject){const e={video:{width:1440,height:1080}};navigator.mediaDevices.getUserMedia(e).then(e=>{t.srcObject=e,t.width=1440,t.height=1080,t.play(),c("webcam")}).catch(e=>{console.error("Error accessing webcam:",e)})}}},"Attiva Webcam"))};function h(){i.a.render(o.a.createElement(g,null),document.getElementById("root"))}h(),window.onload=function(){h()}}},[[252,1,2]]]);
//# sourceMappingURL=main.8ace9374.chunk.js.map