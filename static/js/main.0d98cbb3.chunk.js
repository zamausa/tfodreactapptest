(this.webpackJsonpreactapptestausa=this.webpackJsonpreactapptestausa||[]).push([[0],{227:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=227},252:function(e,t,a){e.exports=a(278)},257:function(e,t,a){},263:function(e,t){},264:function(e,t){},272:function(e,t){},274:function(e,t){},275:function(e,t){},276:function(e,t){},277:function(e,t,a){},278:function(e,t,a){"use strict";a.r(t);var n=a(59),o=a.n(n),c=a(228),i=a.n(c),r=(a(257),a(73)),s=a(94),l=a(250),d=a.n(l);a(277);const u={1:{name:"person",color:"red"},2:{name:"ThumbsDown",color:"yellow"},3:{name:"ThankYou",color:"lime"},4:{name:"LiveLong",color:"blue"}};var m=function(){const e=Object(n.useRef)(null),t=Object(n.useRef)(null),[a,c]=Object(n.useState)("webcam");var i,l,m,h,g,p,w,[f,v]=Object(n.useState)({width:1440,height:1080}),b=!1,y=(new Image,[]),x=[],E=[],j=[],O=[],k=[],C=0,D=new Set;const I=document.createElement("li");var M,S,B;I.id="lista immagini",I.style.display="block",document.createElement("div").style.display="block";var L=[];async function N(e,t){const a=C++,n=new Image(640,480);n.src=e.src,n.id=t,n.onload=await(async function(){const e=await Promise.all(["Elon Musk","Marco","Obama"].map(async e=>{var t=[];for(w=1;w<=8;w++){const a=await r.g("/tfodreactapptest"+"/labels/".concat(e,"/").concat(w,".jpeg")),n=await r.e(a).withFaceLandmarks().withFaceDescriptor();t.push(n.descriptor)}return new r.b(e,t)})),t=new r.a(e),o=r.c(n),c={width:640,height:480};r.h(o,c);const i=await r.d(n).withFaceLandmarks().withFaceDescriptors(),s=r.j(i,c);s.map(e=>t.findBestMatch(e.descriptor));var l=0;if(s.length>=1){const e=t.findBestMatch(s[0].descriptor),c=s[0].detection.box,i=new r.f.DrawBox(c,{label:e});console.log(e),console.log(c),console.log(i),console.log(a),o.width=640,o.height=480,o.style.zIndex=10,o.id="ritaglio";const d=o.getContext("2d"),u=document.createElement("div");u.style.display="flex";let m=!0;console.log("prima "+a),!D.has(n.src)&&m&&!("undefined"===typeof n)&!("undefined"===typeof n.src)&&(console.log("dentro "+a),await d.drawImage(n,0,0),await i.draw(o),document.body.append(I),u.appendChild(o),l=document.createTextNode(n.id),B=document.createTextNode("   "+a),console.log(l),u.appendChild(l),u.appendChild(B),u.id=l.textContent,u.className="immagini",I.appendChild(u),console.log("container "+a),m=!1,D.add(n.src)),console.log("dopo "+a)}})}async function T(e,t,a,n,o,c){if(e&&t&&a&&n&&o&&c){var r=document.createElement("canvas");r.width=640,r.height=480;var s=r.getContext("2d"),l=new Image(640,480);l.src=e,l.onload=async function(){await s.drawImage(l,640*t,480*a,640*n,480*o,0,0,640*n,480*o),i=await r.toDataURL("image/png"),document.getElementById("screenshot").src=i,b=!1;document.getElementById("screenshot");var e=document.createElement("img");e.src=await i,L.push(e),await async function(e,t){for(var a=0;a<e.length;a++){var n=e[a];await N(n,t)}}(L.slice(),c.slice())}}}async function F(e,t,a,n,o,c,i){if(e&&i&&c&&t&&a&&n&&o)for(var r=0;r<i.length;r++)await T(i[r],t[r],a[r],n[r],o[r],c[r])}navigator.mediaDevices.enumerateDevices().then(e=>console.log(e));const A=async a=>{var n=document.getElementById("webcam");if("undefined"!==typeof e.current&&null!==e.current&&4===e.current.video.readyState){console.log("Pausing the webcam stream..."),e.current.video.pause();var o=n.currentTime;console.log(o),console.log("Webcam stream paused.");const c=e.current.video,i=e.current.video.srcObject,r=e.current.video.videoWidth,d=e.current.video.videoHeight;e.current.video.width=r,e.current.video.height=d,t.current.width=r,t.current.height=d;const w=await s.a.fromPixels(c),f=await s.c.resizeBilinear(w,[640,480]),v=await f.cast("int32"),C=await v.expandDims(0),D=await a.executeAsync(C),I=await D[1].array(),B=await D[0].array(),N=await D[4].array(),T=t.current.getContext("2d");y=[],x=[],k=[],O=[],E=[],j=[],L=[],await async function(){for(var t=0;t<N[0].length;t++){if(!(N[0][t]>.5)){await F(b,E.slice(),j.slice(),O.slice(),k.slice(),x.slice(),y.slice());break}p=await e.current.getScreenshot(),y.push(p),S=((M=new Date).getHours()<10?"0"+M.getHours():M.getHours())+":"+(M.getMinutes()<10?"0"+M.getMinutes():M.getMinutes())+":"+(M.getSeconds()<10?"0"+M.getSeconds():M.getSeconds()),x.push(S),b=!0,l=I[0][t][1],E.push(l),m=I[0][t][0],j.push(m),h=I[0][t][3]-I[0][t][1],O.push(h),g=I[0][t][2]-I[0][t][0],k.push(g)}}(),console.log(I[0][0]),((e,t,a,n,o,c,i)=>{for(let r=0;r<=e.length;r++)if(e[r]&&t[r]&&a[r]>n){const[n,s,l,d]=e[r],m=t[r];1===m&&(i.strokeStyle=u[m].color,i.lineWidth=5,i.fillStyle="white",i.font="30px Arial",i.beginPath(),i.fillText(u[m].name+" - "+Math.round(100*a[r])/100,s*o,n*c-10),i.rect(s*o,n*c,(d-s)*o,(l-n)*c),i.stroke())}})(I[0],B[0],N[0],.5,r,d,T),34.48===o&&(o=0),e.current.video.srcObject=null,n.currentTime=await o,e.current.video.srcObject=await i,s.b(w),s.b(f),s.b(v),s.b(C),s.b(D)}return p};return Object(n.useEffect)(()=>{(async()=>{const e=await s.d("https://testtfodausa.s3.eu-de.cloud-object-storage.appdomain.cloud/model.json");Promise.all([r.i.ssdMobilenetv1.loadFromUri("/tfodreactapptest/models"),r.i.faceLandmark68Net.loadFromUri("/tfodreactapptest/models"),r.i.faceRecognitionNet.loadFromUri("/tfodreactapptest/models")]),setInterval(()=>{A(e)},5e3)})()},[]),o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"App-header"},o.a.createElement(d.a,{ref:e,videoConstraints:f,id:"webcam",muted:!0,style:{position:"absolute",marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center",zindex:9,width:640,height:480}}),o.a.createElement("canvas",{ref:t,style:{position:"absolute",marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center",zindex:8,width:640,height:480}}),o.a.createElement("img",{id:"screenshot",alt:"Screenshot",style:{width:640,height:480}})),o.a.createElement("button",{onClick:function(){var t=document.getElementById("webcam");e.current.video.srcObject&&(e.current.video.pause(),e.current.video.srcObject=null,t.src="/tfodreactapptest/video/alley.mp4",t.width=640,t.height=480,t.style.width="640px",t.style.height="480px",t.style.aspectRatio="4 / 3",t.play())}},"Test video 1"),o.a.createElement("button",{onClick:function(){var t=e.current.video;if(!t.srcObject){const e={video:{width:1440,height:1080}};navigator.mediaDevices.getUserMedia(e).then(e=>{t.srcObject=e,t.width=1440,t.height=1080,t.play(),c("webcam")}).catch(e=>{console.error("Error accessing webcam:",e)})}}},"Attiva Webcam"))};function h(){i.a.render(o.a.createElement(m,null),document.getElementById("root"))}h(),window.onload=function(){h()}}},[[252,1,2]]]);
//# sourceMappingURL=main.0d98cbb3.chunk.js.map